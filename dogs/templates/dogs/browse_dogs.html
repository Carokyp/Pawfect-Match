{% extends "base_auth.html" %}
{% load static %}

{% block title %}Discover{% endblock %}
{% block content_class %}discover-page-wrapper{% endblock %}

{% block content %}

<div class="discover-page">

  <!-- APP HEADER -->
  <header class="discover-header">
    <h1 class="app-logo m-0">Pawfect Match</h1>
  </header>

  {% if dog %}

  <!-- PROFILE CARD -->
  <div class="profile-card">

    <!-- TOGGLE -->
    <div class="profile-toggle">
      <button class="toggle-btn active" data-view="dog">Dog</button>
      <button class="toggle-btn" data-view="owner">Owner</button>
    </div>

    <!-- DOG VIEW -->
    <div class="profile-view dog-view">

      <div class="profile-image">
        {% if dog.profile_photo %}
          <img src="{{ dog.get_photo_url }}" alt="Dog photo">
        {% else %}
          <img src="{% static 'images/dog-placeholder.jpg' %}" alt="Dog placeholder">
        {% endif %}

        <div class="image-overlay left">
          <h2>{{ dog.name }}, {{ dog.age }}</h2>
          <p>{{ dog.breed }}</p>
          <p>{{ dog.owner.city }}</p>
        </div>
      </div>

      <hr class="profile-divider">

      <div class="profile-about center">
        <h3>About me</h3>
        <p>{{ dog.about_me }}</p>
      </div>

      <hr class="profile-divider">

      <div class="profile-meta">
        <div class="meta-block">
          <h4>Energy level</h4>
          <span class="tag">{{ dog.get_energy_level_display }}</span>
        </div>

        <div class="meta-block">
          <h4>Size</h4>
          <span class="tag">{{ dog.get_size_display }}</span>
        </div>
      </div>

    </div>

    <!-- OWNER VIEW -->
    <div class="profile-view owner-view hidden">

      <div class="profile-image">
        {% if dog.owner.profile_photo %}
          <img src="{{ dog.owner.get_photo_url }}" alt="Owner photo">
        {% else %}
          <img src="{% static 'images/man-placeholder.jpg' %}" alt="Owner placeholder">
        {% endif %}

        <div class="image-overlay left">
          <h2>{{ dog.owner.name }}, {{ dog.owner.age }}</h2>
          <p>{{ dog.owner.occupation }}</p>
          <p>{{ dog.owner.city }}</p>
        </div>
      </div>

      <hr class="profile-divider">

      <div class="profile-about center">
        <h3>About me</h3>
        <p>{{ dog.owner.about_me }}</p>
      </div>

      <hr class="profile-divider">

      <div class="profile-interests left">
        <h4>Interests</h4>
        <div class="profile-tags">
          {% for interest in dog.owner.interests_list %}
            <span class="tag">{{ interest }}</span>
          {% endfor %}
        </div>
      </div>

    </div>

    <!-- ACTION BUTTONS -->
    <div class="action-buttons">
      <form method="post" action="{% url 'next_dog' %}">
        {% csrf_token %}
        <button type="submit" class="action-btn dislike">‚úï</button>
      </form>

      <form method="post" action="{% url 'like_dog' dog.id %}">
        {% csrf_token %}
        <button type="submit" class="action-btn like">‚ù§</button>
      </form>
    </div>

    <!-- BOTTOM NAV -->
    <nav class="bottom-nav">
      <a class="active">Discover</a>
      <a>Matches</a>
      <a>Profile</a>
    </nav>

  </div>

  {% else %}

  <div style="text-align:center; padding:2.5rem;">
    <p style="font-size:1.1rem;">
      No more dogs to discover üê∂
    </p>
    <p style="opacity:0.6;">
      Check back later for new pups!
    </p>
  </div>

  {% endif %}

</div>

{% endblock %}
